---
title: Splunk ile Otomatik IOC Bloklama
date: 2023-09-24 10:04:00 +07:00
tags: [splunk,ioc,threat]
description: test
---

<h3>Splunk ile Otomatik IOC Blocklama</h3>

Merhabalar
Bugün Splunk üzerinden IP/Domain engelleme işlemi yapacağız.

<hr>
-Lookup Oluşturma-
<hr>

İlk olarak Splunk üzerinden bir adet lookup oluşturmamız gerekiyor. Mevcutta bir lookup bulunuyorsa bunu da kullanabilirsiniz veya dashboard alanında lookup'ı otomatik oluşturabiliriz(Bu şekilde yapmak isterseniz eğer 2.ve 3. adımı en son yapmanız gerekir.)

```ruby
Lookup Editor > Create a new lookup>lookup_name.csv > Save Lookup
```
<img src="https://mustafayilmaz.co/img/lookup.png">

<hr>
-Lookup Definitions-
<hr>

Oluşturduğumuz lookup tanımlamasını yapmak için;

```bash
Settings > Lookup > Lookup definitions > New Lookup Definition
```
Dest APP seçiyoruz, definitions name ve lookup file alanından oluşturduğuğumuz lookup ismini seçip kayıt ediyoruz.

<img src="https://mustafayilmaz.co/img/lookup-definitions.png">

<hr>
-Threat Intelligence threatlist oluşturma- 
<hr>

Bu işlemi Splunk ES Threat intelligence modülüne tanımlayacağız. 
```py
Apps > Enterprise Security > Configure > Data Enrichment > Threat Intelligence Management > New > local
```

Intel kaynağımızı eklemek için gerekli adımları dolduruyoruz ve kayıt ediyoruz.

<img src="https://mustafayilmaz.co/img/threat_intel_threatlist.png">

Engellediğimiz/Engelleyeceğimiz IP/Domain listesini artık aktif olarak Threat Intelligence modülünde farklı şekillerde kullanabileceğiz. Ayrıca ip_intel KV store içerisinde threat key olarak intel kaynağımızı görebileceğiz.
<hr>
-Dashboard Oluşturma-
<hr>

SOC Ekibinin kullandığı ortak bir App içerisinde yeni bir dashboard oluşturalım.

Oluşturduğumuz dashboard içerisinden source alanına tıklayarak aşağıdaki dashboard kodlarını yapıştırıp, oluşturduğumuz lookup ismini editleyelim. 

`Resime tıklayıp dashboarda ait videoyu izleyebilirsiniz.`

[![Watch the video](https://mustafayilmaz.co/img/dashboard_ss.png)](https://mustafayilmaz.co/img/soc_dashbord.mp4)
